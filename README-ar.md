# الرسائل المجهولة لـ WordPress

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![WordPress](https://img.shields.io/badge/WordPress-5.0%2B-blue.svg)](https://wordpress.org/)
[![PHP](https://img.shields.io/badge/PHP-7.4%2B-purple.svg)](https://php.net/)

إضافة لـ WordPress تتيح لزوار الموقع إرسال رسائل مجهولة من خلال بلوك Gutenberg قابل للتخصيص مع حماية متقدمة من الرسائل المزعجة وإدارة المستخدمين ومزايا إدارية شاملة.

## 🚀 المزايا

### 🎯 الميزات الرئيسية
- **تكامل مع Gutenberg Block**: بلوك سهل الاستخدام لمحرر WordPress
- **الرسائل المجهولة**: يمكن للزوار إرسال رسائل دون الكشف عن هويتهم

### 📱 الواجهة الأمامية
- **البحث الفوري**: بحث في الوقت الفعلي
- **الفلترة المباشرة**: دمج البحث مع فلترة الفئات
- **التصميم المتجاوب**: واجهة متوافقة مع الهواتف المحمولة

### ⚙️ لوحة التحكم
- **إدارة الرسائل**: عرض والرد على وإدارة جميع الرسائل
- **أنواع الردود المتعددة**: إجابات نصية قصيرة – منشورات WordPress كاملة
- **إدارة الحالة**: حالات الرسائل: معلقة، مجابة، ومميزة
    - **التصدير**: تصدير الرسائل مع خيارات الفلترة
    - **إشعارات البريد الإلكتروني**: تلقي تنبيهات بالبريد الإلكتروني للرسائل الجديدة (يُرسل للمستخدم المعين أو مدير الموقع)
    - **عداد في شريط الإدارة**: عرض عدد الرسائل المعلقة بلمحة واحدة (واجهة أمامية وخلفية، مع شارة حمراء)

### 👥 إدارة المستخدمين
- **صندوق مخصص للمستخدم**: يمكن تعيين الرسائل الواردة عبر نموذج محدد لمستخدم محدد في WordPress

### 🛡️ الأمان
- **Google reCAPTCHA v3**: كابتشا خفية للحماية من الرسائل المزعجة
- **تحديد معدل الإرسال**: فترات انتظار بين الرسائل قابلة للتعديل (افتراضي: 60 ثانية)
- **حماية Honeypot**: حقول مخفية لاكتشاف البوتات الآلية
- **تطهير المدخلات**: التحقق الشامل وتنظيف البيانات
- **التحقق من Nonce**: حماية CSRF لجميع الإجراءات الإدارية

### 🏷️ نظام الفئات
- **فلترة الفئات**: يمكن للزوار فلترة الأسئلة المجابة حسب الفئة

### 🔧 التكامل
- **استخدام أنواع المنشورات الموجودة كنوع منشور معتمد للردود**
- **تكامل القالب**: تصميم خاص لقالب بلوكسي يستخدم تنسيقات القالب مباشرة

### 🌍 التدويل
- **جاهز للترجمة**: دعم كامل متعدد اللغات
- **ملفات POT**: قالب الترجمة متضمن
- **الترجمة العربية**: ترجمة عربية كاملة متضمنة
- **دعم RTL**: توافق مع اللغات التي تُكتب من اليمين إلى اليسار

## 📋 المتطلبات

- **WordPress**: 5.0 أو أحدث
- **PHP**: 7.4 أو أحدث
- **MySQL**: 5.7 أو أحدث
- **Google reCAPTCHA**: مفاتيح API مطلوبة للحماية من الرسائل المزعجة

## 🛠️ التثبيت

### الطريقة الأولى: رفع الإضافة
1. تحميل ملفات الإضافة
2. رفع مجلد `anonymous-messages` إلى `/wp-content/plugins/`
3. تفعيل الإضافة من خلال قائمة 'الإضافات' في WordPress
4. تكوين الإعدادات في **الرسائل المجهولة > الإعدادات**

### الطريقة الثانية: إدارة WordPress
1. انتقل إلى **الإضافات > إضافة جديد** في إدارة WordPress
2. رفع ملف zip الخاص بالإضافة
3. تفعيل الإضافة
4. تكوين الإعدادات

## ⚙️ التكوين

### 1. إعداد Google reCAPTCHA
1. زيارة [Google reCAPTCHA](https://www.google.com/recaptcha/)
2. تسجيل موقعك لـ reCAPTCHA v3
3. نسخ مفتاح الموقع والمفتاح السري
4. انتقل إلى **الرسائل المجهولة > الإعدادات**
5. أدخل بيانات اعتماد reCAPTCHA

### 2. الإعدادات الأساسية
- **تحديد معدل الإرسال**: تعيين فترة الانتظار بين الإرسالات
- **الرسائل لكل صفحة**: تكوين التصفح للأسئلة المجابة
- **الفئات**: تمكين/تعطيل نظام الفئات
- **الرسائل المميزة**: السماح بوضع علامة على الرسائل كمميزة

### 3. تكوين إجابة المنشور
اختر كيفية التعامل مع الردود التفصيلية:
- **نوع منشور موجود**: استخدام منشورات أو صفحات WordPress
- **نوع منشور مخصص**: إنشاء نوع منشور مخصص "إجابات مجهولة"
- **معطل**: السماح بالردود النصية القصيرة فقط

## 📝 الاستخدام

### إضافة البلوك
1. تحرير أي صفحة أو منشور
2. إضافة بلوك جديد والبحث عن "الرسائل المجهولة"
3. تكوين إعدادات البلوك:
   - إظهار/إخفاء فلترة الفئات
   - إظهار/إخفاء قسم الأسئلة المجابة
   - تعيين الأسئلة لكل صفحة
   - تمكين/تعطيل reCAPTCHA
   - التعيين لمستخدم محدد (إذا تم التكوين)
   - تمكين/تعطيل إشعارات البريد الإلكتروني للمستخدم المعين

### خصائص البلوك
- `showCategories`: عرض فلتر الفئات للأسئلة المجابة
- `showAnsweredQuestions`: إظهار قسم الأسئلة المجابة
- `questionsPerPage`: عدد الأسئلة لكل صفحة
- `enableRecaptcha`: تمكين حماية reCAPTCHA
- `assignedUserId`: تعيين الرسائل لمستخدمين محددين
- `enableEmailNotifications`: إرسال إشعار بالبريد الإلكتروني للمستخدم المعين
- `placeholder`: نص العنصر النائب المخصص

### إدارة الرسائل
1. انتقل إلى **الرسائل المجهولة > الرسائل**
2. عرض جميع الرسائل المرسلة
3. الرد بإجابات قصيرة أو إنشاء منشورات كاملة
4. تعيين الفئات وتحديث الحالة
5. وضع علامة على الرسائل المهمة كمميزة

### إدارة الفئات
1. انتقل إلى **الرسائل المجهولة > الفئات**
2. إنشاء فئات جديدة بأسماء وأوصاف
3. تعيين الفئات للرسائل من صفحة الرسائل
4. الفئات تساعد في تنظيم المحتوى للزوار

## 🎨 التخصيص

### تصميم CSS
تتضمن الإضافة CSS شامل للتصميم:
- `assets/css/block-style.css` - التصميم الافتراضي
- `assets/css/block-style-blocksy.css` - تكامل قالب Blocksy
- `assets/css/admin-style.css` - تصميم واجهة الإدارة

### تكامل القالب
تكتشف الإضافة تلقائياً القوالب الشائعة وتطبق التصميم المناسب. تتضمن حالياً تكاملاً خاصاً مع:
- قالب Blocksy
- قوالب WordPress الافتراضية

### الـ Hooks والـ Filters
توفر الإضافة hooks مختلفة للتخصيص:
- `anonymous_messages_before_submission`
- `anonymous_messages_after_submission`
- `anonymous_messages_message_saved`
- `anonymous_messages_response_created`

## 🔧 هيكل قاعدة البيانات

### الجداول المنشأة
- `wp_anonymous_messages`: تخزين الرسائل الأساسية
- `wp_anonymous_message_categories`: إدارة الفئات
- `wp_anonymous_message_responses`: ردود الرسائل

### إصدارات قاعدة البيانات
تتضمن الإضافة نظام ترحيل تلقائي لقاعدة البيانات للتحديثات.

## 🛡️ مزايا الأمان

- **التحقق من المدخلات**: جميع المدخلات يتم تطهيرها والتحقق منها
- **منع حقن SQL**: بيانات محضرة لجميع استعلامات قاعدة البيانات
- **حماية XSS**: هروب صحيح للمخرجات
- **حماية CSRF**: التحقق من nonce لجميع الإجراءات الإدارية
- **تحديد معدل الإرسال**: حدود إرسال جانب الخادم والعميل
- **فحوصات القدرات**: التحقق الصحيح من الصلاحيات

## 🌐 نقاط API

### نقاط AJAX
- `submit_anonymous_message`: التعامل مع إرسالات الرسائل
- `get_answered_questions`: استرداد الأسئلة المجابة مع الفلترة
- `am_respond_to_message`: التعامل مع ردود المشرف
- `am_update_message_status`: تحديثات الحالة
- `am_update_message_category`: تعيين الفئة

## 📊 الأداء

- **استعلامات محسنة**: استعلامات قاعدة بيانات فعالة مع فهرسة مناسبة
- **تحميل AJAX**: إعادة تحميل صفحات أقل لتجربة مستخدم أفضل
- **بحث مؤجل**: بحث محسن مع تأخير 300ms
- **التصفح**: تعامل فعال مع مجموعات البيانات الكبيرة

## 🤝 المساهمة

المساهمات مرحب بها! يرجى التكرم بإرسال Pull Request. للتغييرات الكبيرة، يرجى فتح issue أولاً لمناقشة ما تريد تغييره.

### إعداد التطوير
1. استنساخ المستودع
2. إعداد بيئة تطوير WordPress محلية
3. تثبيت الإضافة في وضع التطوير
4. إجراء التغييرات والاختبار بدقة

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT - انظر ملف [LICENSE](LICENSE) للتفاصيل.

## 👨‍💻 المؤلف

**هادي الأحمد**
- الموقع: [hadealahmad.com](https://hadealahmad.com)
- GitHub: [@hadealahmad](https://github.com/hadealahmad)

## 🙏 الشكر والتقدير

- مجتمع WordPress للتوثيق الممتاز
- Google reCAPTCHA للحماية من الرسائل المزعجة
- جميع المساهمين والمختبرين

## 📈 سجل التغييرات

### الإصدار 1.1.0
- إشعارات البريد الإلكتروني
- إشعارات الداشبورد

### الإصدار 1.0.1
- تحسين الوصف
- تصحيح مشاكل العرض على الهاتف المحمول في ثيم بلوكسي

### الإصدار 1.0.0
- الإصدار الأولي
- وظائف الرسائل الأساسية
- تكامل Gutenberg block
- نظام الإدارة
- تنفيذ مزايا الأمان
- الدعم متعدد اللغات
- نظام تعيين المستخدمين
- إدارة الفئات المتقدمة

---

لمزيد من المعلومات، قم بزيارة [الصفحة الرئيسية للإضافة](https://github.com/hadealahmad/anonymous-messages)